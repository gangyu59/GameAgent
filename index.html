<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>二人围棋</title>

    <!-- 依赖库 -->
    <script src="https://cdn.jsdelivr.net/npm/peerjs@1.4.7/dist/peerjs.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <!-- 样式 -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <h2 style="text-align:center;">二人围棋</h2>

    <!-- 房间控制 UI -->
    <div style="text-align:center; margin-top:20px;">
      <button onclick="window.UI.createRoomAndShowId()">创建房间</button>
      <input id="roomIdInput" placeholder="输入房间ID" style="width:160px; margin-left:10px;" />
      <button onclick="window.UI.joinRoomFromInput()">加入房间</button>
      <div id="roomInfo" style="margin-top:10px; color:blue;"></div>
    </div>

    <!-- 棋盘区域 -->
    <div id="board"></div>

    <!-- 日志输出 -->
    <div id="debug-panel" style="position:fixed; bottom:0; background:#f5f5f5; padding:10px; width:100%;">
        <h3>调试信息</h3>
        <div id="debug-log"></div>
    </div>
		
<!-- 控制台开关按钮 -->
<div id="mobile-console-toggle" onclick="toggleConsole()">调试台</div>

<!-- 控制台本体 -->
<div id="mobile-console">
  <button onclick="document.getElementById('mobile-console').style.display='none'" style="float:right; background:#555; color:white; border:none;">关闭</button>
  <div id="console-log"></div>
</div>

      <button onclick="this.parentNode.remove()" style="float:right">关闭</button>
      <div id="console-log"></div>
    </div>

    <!-- 所有 JS 模块按顺序加载 -->
    <script src="js/firebase-init.js"></script>
    <script src="js/webrtc-conn.js"></script>
    <script src="js/game-logic.js"></script>
    <script src="js/ui-render.js"></script>
    <script src="js/utils.js"></script>

    <!-- 控制台重定向 -->
    <script>
      const originalConsole = {...console};
      window.console = {
        log: (...args) => {
          originalConsole.log(...args);
          document.getElementById('console-log').innerHTML +=
            `<div style="color:#0f0">${args.join(' ')}</div>`;
        },
        error: (...args) => {
          originalConsole.error(...args);
          document.getElementById('console-log').innerHTML +=
            `<div style="color:#f00">${args.join(' ')}</div>`;
        }
      };
			
  function toggleConsole() {
    const panel = document.getElementById("mobile-console");
    panel.style.display = panel.style.display === "none" ? "block" : "none";
  }
    </script>

    <!-- 初始化逻辑 -->
    <script>
      window.game = {
        players: [],
        currentPlayer: 'black',
        boardSize: 19
      };

      document.addEventListener('DOMContentLoaded', () => {
        renderBoard();
        console.log("系统启动完成");
      });
    </script>
</body>
</html>